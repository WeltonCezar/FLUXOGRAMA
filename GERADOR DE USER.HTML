<!DOCTYPE html> <html lang="pt-BR"> <head> <meta charset="UTF-8"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <title>Gerador de Acessos Standalone</title> <style> /* [Etapa 1: UI - In√≠cio] Inicia o bloco de estilo visual do gerador usando coment√°rios corretos de CSS */
        body { font-family: 'Segoe UI', sans-serif; background: #f0f2f5; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; } /* [Estilo Body] Centraliza o cart√£o na tela e usa o mesmo fundo do projeto principal */
        .card { background: white; padding: 40px; border-radius: 12px; box-shadow: 0 15px 30px rgba(0,0,0,0.2); width: 350px; text-align: center; } /* [Estilo Card] Define a caixa central branca com cantos arredondados e sombra */
        .input-group { margin-bottom: 15px; text-align: left; } /* [Estilo Agrupador] Cria um espa√ßamento vertical entre os campos do formul√°rio */
        .input-group label { display: block; font-size: 14px; font-weight: bold; color: #555; margin-bottom: 5px; } /* [Estilo R√≥tulo] Formata o texto indicativo acima dos campos */
        input[type="text"] { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px; box-sizing: border-box; } /* [Estilo Input] Formata as caixas de texto de usu√°rio e senha */
        .checkbox-group { display: flex; align-items: center; justify-content: start; gap: 8px; margin-bottom: 20px; font-size: 14px; color: #555; } /* [Estilo Checkbox] Alinha horizontalmente a caixa de sele√ß√£o e o r√≥tulo */
        button { width: 100%; padding: 12px; background: #28a745; color: white; border: none; border-radius: 6px; font-weight: bold; cursor: pointer; font-size: 16px; transition: 0.2s; } /* [Estilo Bot√£o] Estiliza o bot√£o principal na cor verde */
        button:hover { background: #218838; } /* [Estilo Intera√ß√£o] Escurece o bot√£o quando o mouse passa por cima */
        h2 { margin-top: 0; color: #333; margin-bottom: 20px; } /* [Estilo T√≠tulo Interno] Remove margens excedentes do t√≠tulo dentro do cart√£o */
    </style> </head> <body> <div class="card"> <h2>Gerador R√°pido de Acesso</h2> <div class="input-group"> <label>Nome do Usu√°rio:</label> <input type="text" id="gen-user" placeholder="EX: CESAR.BATISTA"> </div> <div class="input-group"> <label>Senha Provis√≥ria (Default):</label> <input type="text" id="gen-pass" value="123456"> </div> <div class="checkbox-group"> <input type="checkbox" id="gen-admin"> <label for="gen-admin" style="margin:0; cursor:pointer;">√â Administrador do Sistema?</label> </div> <button onclick="gerarEBaixarUsuario()">üì• Gerar e Baixar (.json)</button> </div> <script> // [L√≥gica] Inicia o bloco de JavaScript com o formato correto de coment√°rio
        
        // --- ETAPA 2: TRANSPLANTE DO MOTOR DE CRIPTOGRAFIA --- // [Coment√°rio de Bloco] Replica√ß√£o das regras do cliente
        const ITERATIONS = 100000; // [Etapa 2: Motor] Define as 100.000 itera√ß√µes de seguran√ßa (V5 Banc√°ria)
        const ALGO_NAME = "PBKDF2"; // [Etapa 2: Motor] Define o algoritmo de deriva√ß√£o de chave para compatibilidade
        const HASH_NAME = "SHA-256"; // [Etapa 2: Motor] Define o padr√£o de hash SHA-256 id√™ntico ao do cliente

        function generateSalt(length = 16) { // [Etapa 2: Motor] Fun√ß√£o que gera o tempero criptogr√°fico (salt)
            const arr = new Uint8Array(length); // [Etapa 2: Motor] Cria uma matriz de bytes
            crypto.getRandomValues(arr); // [Etapa 2: Motor] Popula a matriz com n√∫meros aleat√≥rios seguros nativos do navegador
            return Array.from(arr).map(b => b.toString(16).padStart(2, '0')).join(''); // [Etapa 2: Motor] Converte os bytes para string hexadecimal
        } // [Etapa 2: Motor] Fim da fun√ß√£o de gera√ß√£o de salt

        async function hashPasswordV2(password, saltHex) { // [Etapa 2: Motor] Fun√ß√£o ass√≠ncrona que criptografa a senha crua
            const enc = new TextEncoder(); // [Etapa 2: Motor] Inicia o codificador para transformar a senha em bin√°rio
            const salt = new Uint8Array(saltHex.match(/.{1,2}/g).map(byte => parseInt(byte, 16))); // [Etapa 2: Motor] Converte o salt hexa para bytes novamente
            const keyMaterial = await crypto.subtle.importKey("raw", enc.encode(password), { name: ALGO_NAME }, false, ["deriveBits"]); // [Etapa 2: Motor] Transforma a senha em material criptogr√°fico
            const derivedBits = await crypto.subtle.deriveBits({ name: ALGO_NAME, salt: salt, iterations: ITERATIONS, hash: HASH_NAME }, keyMaterial, 256); // [Etapa 2: Motor] Aplica PBKDF2 misturando senha e salt
            return Array.from(new Uint8Array(derivedBits)).map(b => b.toString(16).padStart(2, '0')).join(''); // [Etapa 2: Motor] Retorna o hash seguro e irrevers√≠vel
        } // [Etapa 2: Motor] Fim da fun√ß√£o de hashing

        // --- ETAPA 3: L√ìGICA DE EXPORTA√á√ÉO (DOWNLOAD DO ARQUIVO) --- // [Coment√°rio de Bloco] Sinaliza o in√≠cio da rotina que cria e baixa o arquivo
        async function gerarEBaixarUsuario() { // [Etapa 3: Exporta√ß√£o] Inicia a fun√ß√£o disparada no clique do bot√£o
            const u = document.getElementById('gen-user').value.toUpperCase().trim(); // [Etapa 3: Exporta√ß√£o] Captura o usu√°rio e converte para mai√∫sculo
            const p = document.getElementById('gen-pass').value; // [Etapa 3: Exporta√ß√£o] Captura a senha provis√≥ria
            const isAdmin = document.getElementById('gen-admin').checked; // [Etapa 3: Exporta√ß√£o] Verifica se a checkbox de admin est√° ativada

            if (!u || !p) { // [Etapa 3: Exporta√ß√£o] Checa se os inputs est√£o em branco
                alert("Por favor, preencha o Nome do Usu√°rio e a Senha Provis√≥ria."); // [Etapa 3: Exporta√ß√£o] Alerta de erro de preenchimento
                return; // [Etapa 3: Exporta√ß√£o] Interrompe a execu√ß√£o
            } // [Etapa 3: Exporta√ß√£o] Fim da valida√ß√£o

            const newSalt = generateSalt(); // [Etapa 3: Exporta√ß√£o] Gera o salt exclusivo (Etapa 2)
            const hashedPass = await hashPasswordV2(p, newSalt); // [Etapa 3: Exporta√ß√£o] Gera o hash seguro (Etapa 2)

            const newUserObj = { // [Etapa 3: Exporta√ß√£o] Constr√≥i a estrutura de dados que o cliente espera ler
                u: u, // [Etapa 3: Exporta√ß√£o] Nome de usu√°rio
                p: hashedPass, // [Etapa 3: Exporta√ß√£o] Senha criptografada
                s: newSalt, // [Etapa 3: Exporta√ß√£o] Salt associado √† senha
                r: isAdmin ? 'admin' : 'user', // [Etapa 3: Exporta√ß√£o] Define permiss√£o (role) do usu√°rio
                st: 'reset', // [Etapa 3: Exporta√ß√£o] Trava como 'reset' para for√ßar a troca no 1¬∫ acesso
                f: 0, // [Etapa 3: Exporta√ß√£o] Falhas de login zeradas
                security: null // [Etapa 3: Exporta√ß√£o] Sem perguntas de seguran√ßa pr√©vias
            }; // [Etapa 3: Exporta√ß√£o] Fim da cria√ß√£o do objeto

            const jsonOutput = JSON.stringify([newUserObj]); // [Etapa 3: Exporta√ß√£o] Transforma o objeto em lista JSON
            const blob = new Blob([jsonOutput], { type: 'application/json' }); // [Etapa 3: Exporta√ß√£o] (CORRE√á√ÉO) Cria arquivo Blob seguro na mem√≥ria
            const url = URL.createObjectURL(blob); // [Etapa 3: Exporta√ß√£o] (CORRE√á√ÉO) Gera link local para o Blob
            
            const downloadAnchorNode = document.createElement('a'); // [Etapa 3: Exporta√ß√£o] (CORRE√á√ÉO) Cria elemento de √¢ncora invis√≠vel
            downloadAnchorNode.href = url; // [Etapa 3: Exporta√ß√£o] (CORRE√á√ÉO) Aponta o href para o link local do Blob
            downloadAnchorNode.download = `Acesso_${u}.json`; // [Etapa 3: Exporta√ß√£o] (CORRE√á√ÉO) Define o nome padr√£o do download
            
            document.body.appendChild(downloadAnchorNode); // [Etapa 3: Exporta√ß√£o] (CORRE√á√ÉO) Adiciona link √† p√°gina
            downloadAnchorNode.click(); // [Etapa 3: Exporta√ß√£o] (CORRE√á√ÉO) For√ßa clique autom√°tico
            
            document.body.removeChild(downloadAnchorNode); // [Etapa 3: Exporta√ß√£o] (CORRE√á√ÉO) Remove link da p√°gina
            URL.revokeObjectURL(url); // [Etapa 3: Exporta√ß√£o] (CORRE√á√ÉO) Revoga link da mem√≥ria para n√£o vazar recursos
            
            alert(`‚úÖ Sucesso!\nO arquivo Acesso_${u}.json foi gerado e baixado.`); // [Etapa 3: Exporta√ß√£o] Alerta de confirma√ß√£o
            document.getElementById('gen-user').value = ''; // [Etapa 3: Exporta√ß√£o] Limpa apenas o campo de usu√°rio
        } // [Etapa 3: Exporta√ß√£o] Fim da fun√ß√£o gerarEBaixarUsuario
    </script>

</body> </html>